(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{1331:function(t,e,n){var content=n(1383);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(7).default)("5f725f32",content,!0,{sourceMap:!1})},1382:function(t,e,n){"use strict";var r=n(1331);n.n(r).a},1383:function(t,e,n){(e=n(6)(!1)).push([t.i,".program-span[data-v-666637e0]{display:inline-flex}.program-text-span[data-v-666637e0]{margin-left:20px}",""]),t.exports=e},1409:function(t,e,n){"use strict";n.r(e);n(46),n(50),n(8);var r,o=n(3),c=(n(55),{name:"taskType",props:["task"],data:function(){return{type:null,check:[]}},watch:{type:(r=Object(o.a)(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(2!==e){t.next=3;break}return t.next=3,this.loadAttemps();case 3:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},computed:{taskId:function(){if(this.task)return this.task._id},attemps:function(){return this.task?this.$store.getters["teacher/programming/attemp/attempsResolve"](this.taskId):[]},solvedAttemp:function(){var t=this;if(this.task)return this.attemps.find((function(e){return e._id===t.task.solvedAttemp}))},solvedProgram:function(){if(this.solvedAttemp)return this.solvedAttemp.program}},mounted:function(){var t=this.task;t.type&&(this.type=t.type)},methods:{loadAttemps:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("teacher/programming/attemp/loadResolveAttemps",{taskId:t.taskId});case 2:n=e.sent,r=n.error,o=n.errorMessage,r&&o&&t.$notify.error({title:"Произошла ошибка",message:o}),t.compiling&&t.timeout.push(setTimeout(t.reloadAttemps,5e3));case 7:case"end":return e.stop()}}),e)})))()},variant:function(t){return this.type&&this.type===t?"success":""}}}),l=(n(1382),n(2)),m=Object(l.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-button-group",[n("b-button",{attrs:{active:1===t.type,variant:t.variant(1)},on:{click:function(e){t.type=1}}},[t._v("Обычная задача")]),t._v(" "),n("b-button",{attrs:{active:2===t.type,variant:t.variant(2)},on:{click:function(e){t.type=2}}},[t._v("Задача с заданным шаблоном")]),t._v(" "),t.type?n("b-button",{attrs:{variant:"success"},on:{click:function(e){return t.$emit("set-task-type",{type:t.type,check:t.check,solvedProgram:t.solvedProgram})}}},[t._v("Сохранить")]):t._e()],1),t._v(" "),t.solvedProgram&&2===t.type?n("div",[n("h4",[t._v("Создайте шаблон:")]),t._v(" "),t._l(t.solvedProgram.split("\n"),(function(e,i){return n("div",[t.check[i]?n("p",{staticClass:"program-span"},[n("b-checkbox",{model:{value:t.check[i],callback:function(e){t.$set(t.check,i,e)},expression:"check[i]"}}),t._v(" "),n("span",{domProps:{innerHTML:t._s(i+1)}})],1):n("p",{staticClass:"program-span"},[n("b-checkbox",{model:{value:t.check[i],callback:function(e){t.$set(t.check,i,e)},expression:"check[i]"}}),t._v(" "),n("span",{domProps:{innerHTML:t._s(i+1)}}),t._v(" "),n("span",{staticClass:"program-text-span"},[t._v(t._s(e))])],1)])}))],2):t._e()],1)}),[],!1,null,"666637e0",null).exports,d=n(176),h={name:"taskLangs",props:["task"],data:function(){return{value:[],defaultLanguage:null,languagesModel:[],loadingButton:!1,loadingPage:!0}},watch:{languagesModel:function(t){var e=this;this.value=[],t.forEach((function(t){t.selected&&e.value.push(t._id)}))}},computed:{languages:function(){return this.$store.getters["teacher/programming/languages/languages"]}},mounted:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.loadLanguages();case 2:return e.next=4,t.loadDefaultLang();case 4:t.setLanguages(),t.setDefaultLang(!0),t.loadingPage=!1;case 7:case"end":return e.stop()}}),e)})))()},methods:{setDefaultLang:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e&&this.task.langs&&(this.value=Object(d.a)(this.task.langs),this.task.langs.forEach((function(e){t.languagesModel.forEach((function(n,r){n._id===e&&(t.languagesModel[r].selected=!0)}))}))),this.languagesModel.forEach((function(e,i){e._id===t.defaultLanguage&&(t.languagesModel[i].selected=!0),t.value.some((function(e){return e===t.defaultLanguage}))||(t.value.push(t.defaultLanguage),t.$refs.select.update())}))},setLanguages:function(){var t=this;this.languages.forEach((function(e){t.languagesModel.push({text:e.label,value:e._id,_id:e._id})}))},setAcceptedLanguages:function(){var t=null;if(this.setDefaultLang(),0===this.value.length&&(t="Не выбраны языки"),2===this.task.type&&(t="Для этого задания нельзя выбирать языки"),t)return this.$notify.error({title:"Ошибка при настройке",message:t});this.loadingButton=!0,this.$emit("set-langs",{languages:this.value})},loadLanguages:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("teacher/programming/languages/loadLanguages");case 2:case"end":return e.stop()}}),e)})))()},loadDefaultLang:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.post("/api/teacher/programming/languages/taskDefault",{taskId:t.task._id});case 2:n=e.sent.data.defaultLanguage,t.defaultLanguage=n;case 4:case"end":return e.stop()}}),e)})))()}}},f=Object(l.a)(h,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("mdb-container",[n("h1",[t._v("Выберите разрешенные языки для решения задачи:")]),t._v(" "),n("mdb-container",{directives:[{name:"show",rawName:"v-show",value:!t.loadingPage,expression:"!loadingPage"}]},[n("mdb-select",{ref:"select",attrs:{multiple:"",selectAll:"",disabled:2===t.task.type,label:"Example label",placeholder:"choose your option"},on:{change:function(e){return t.setDefaultLang(!1)}},model:{value:t.languagesModel,callback:function(e){t.languagesModel=e},expression:"languagesModel"}}),t._v(" "),n("mdb-btn",{attrs:{disabled:JSON.stringify(t.task.langs)===JSON.stringify(t.value)||t.loadingButton},on:{click:t.setAcceptedLanguages}},[n("span",{directives:[{name:"show",rawName:"v-show",value:t.loadingButton,expression:"loadingButton"}],staticClass:"spinner-grow spinner-grow-sm",attrs:{role:"status","aria-hidden":"true"}}),t._v("\n            Сохранить\n        ")])],1),t._v(" "),n("mdb-container",{directives:[{name:"show",rawName:"v-show",value:t.loadingPage,expression:"loadingPage"}]},[n("div",{staticClass:"ph-item"},[n("div",{staticClass:"ph-col-12"},[n("div",{staticClass:"ph-picture"})])])])],1)}),[],!1,null,"1fe842ec",null).exports,v=(n(27),n(746),{name:"taskTime",props:["task"],data:function(){return{type:0,timeLimit:null}},computed:{attemps:function(){return this.task?this.$store.getters["teacher/programming/attemp/attempsResolve"](this.task._id):[]},solvedAttemp:function(){var t=this;return this.attemps.find((function(e){return e._id===t.task.solvedAttemp}))},maxTime:function(){if(this.solvedAttemp)return Number.parseInt(Math.min.apply(null,this.solvedAttemp.time))}},watch:{timeLimit:function(t){t<this.maxTime&&(this.timeLimit=null),t>1e4&&(this.timeLimit=1e4)},type:function(){var t=Object(o.a)(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(2!==e){t.next=6;break}return t.next=3,this.loadAttemps();case 3:this.timeLimit||(this.timeLimit=this.maxTime),t.next=7;break;case 6:1===e&&(this.timeLimit=0);case 7:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},mounted:function(){this.task&&this.task.timeLimit&&(this.timeLimit=this.task.timeLimit),this.setDefaultType()},methods:{variant:function(t){return this.type&&this.type===t?"success":""},setDefaultType:function(){this.timeLimit?this.type=2:this.type=1},loadAttemps:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("teacher/programming/attemp/loadResolveAttemps",{taskId:t.task._id});case 2:n=e.sent,r=n.error,o=n.errorMessage,r&&o&&t.$notify.error({title:"Произошла ошибка",message:o});case 6:case"end":return e.stop()}}),e)})))()},save:function(){var t=this.type,e=this.timeLimit;1===t?this.$emit("save-task-time",{type:t,timeLimit:0}):2===t&&e&&e>=this.maxTime&&e<=1e4?this.$emit("save-task-time",{type:t,timeLimit:e}):this.$notify.error({title:"Ошибка при сохранении",message:"Временные ограничения заданы неверно"})}}}),k={name:"settings",components:{TaskTime:Object(l.a)(v,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.task?n("div",[n("b-button-group",[n("b-button",{attrs:{active:1===t.type,variant:t.variant(1)},on:{click:function(e){t.type=1}}},[t._v("Автоматическая настройка")]),t._v(" "),n("b-button",{attrs:{active:2===t.type,variant:t.variant(2)},on:{click:function(e){t.type=2}}},[t._v("Ручная настройка")]),t._v(" "),n("b-button",{attrs:{disabled:t.task&&t.task.timeLimit===t.timeLimit||0===t.task.timeLimit&&1===t.type,variant:"success"},on:{click:t.save}},[t._v("Сохранить")])],1),t._v(" "),2===t.type?n("div",[n("b-input",{attrs:{type:"number",min:t.maxTime,max:1e4,trim:"",number:""},model:{value:t.timeLimit,callback:function(e){t.timeLimit=e},expression:"timeLimit"}}),t._v(" "),n("b-form-text",{attrs:{id:"input-live-help"}},[t._v("Минимальное время - "+t._s(t.maxTime))]),t._v(" "),n("b-form-text",{attrs:{id:"input-live-help"}},[t._v("Максимальное время - 10000")])],1):t._e()],1):t._e()}),[],!1,null,"084616fe",null).exports,TaskLangs:f,TaskType:m},layout:"teacher",middleware:"authTeacher",validate:function(t){var e=t.params;return/^\d+$/.test(e.task)},data:function(){return{steps:[{icon:"hammer",far:!0,name:"Тип задания"},{icon:"language",name:"Языки "},{icon:"clock",name:"Ограничения времени"}],validatedSteps:{},options:{stepBtn:{color:"info",active:"amber",iconClass:"white-text"},nextBtn:{outline:"info",icon:"chevron-right",text:"К следующему шагу"},prevBtn:{outline:"info",icon:"chevron-left",text:"К предыдущему шагу"},submitBtn:{color:"amber",icon:"check",text:"К просмотру задания"},lineColor:"amber"}}},computed:{task:function(){return this.$store.getters["teacher/programming/task/task"](this.$route.params.task)}},mounted:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.loadTask();case 2:return e.next=4,t.setStep();case 4:case"end":return e.stop()}}),e)})))()},methods:{loadTask:function(){var t=arguments,e=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.length>0&&void 0!==t[0]&&t[0],n.next=3,e.$store.dispatch("teacher/programming/task/loadTask",{taskId:e.$route.params.task,force:r});case 3:case"end":return n.stop()}}),n)})))()},setTaskType:function(data){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,r,o,template,c,l,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=data.type,r=data.check,o=data.solvedProgram,template=[],2!==n){e.next=6;break}if(r.some((function(t){return!0===t}))){e.next=5;break}return e.abrupt("return",t.$notify.error({title:"Ошибка при настройке",message:"Шаблон не может быть полностью решенной программой"}));case 5:o.split("\n").map((function(t,i){return!r[i-1]&&r[i]?template.push(null):r[i-1]&&r[i]?void 0:template.push(t)})).join("\n").replace("\n\n","\n");case 6:return e.next=8,t.$store.dispatch("teacher/programming/task/setTaskType",{taskId:t.task._id,type:data.type,template:template});case 8:if(c=e.sent,l=c.error,m=c.errorMessage,!l||!m){e.next=15;break}return e.abrupt("return",t.$notify.error({title:"Ошибка настройке",message:m}));case 15:return e.next=17,t.loadTask(!0);case 17:return e.abrupt("return",t.$notify.success({title:"Успех",message:"Тип задания изменен успешно"}));case 18:case"end":return e.stop()}}),e)})))()},setTaskLangs:function(data){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,r,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=data.languages,e.next=3,t.$store.dispatch("teacher/programming/task/setLangs",{languages:n,taskId:t.task._id});case 3:if(r=e.sent,o=r.error,c=r.errorMessage,!o||!c){e.next=11;break}return t.$refs.languages.loadingButton=!1,e.abrupt("return",t.$notify.error({title:"Ошибка настройки",message:c}));case 11:return e.next=13,t.loadTask(!0);case 13:return t.$refs.languages.loadingButton=!1,e.abrupt("return",t.$notify.success({title:"Успех",message:"Языки изменены успешно"}));case 15:case"end":return e.stop()}}),e)})))()},setTaskTime:function(data){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,r,o,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=data.type,r=data.timeLimit,e.next=3,t.$store.dispatch("teacher/programming/task/setTimelimit",{type:n,timeLimit:r,taskId:t.task._id});case 3:if(o=e.sent,c=o.error,l=o.errorMessage,!c||!l){e.next=10;break}return e.abrupt("return",t.$notify.error({title:"Ошибка настройки",message:l}));case 10:return e.next=12,t.loadTask(!0);case 12:return e.abrupt("return",t.$notify.success({title:"Успех",message:"Языки изменены успешно"}));case 13:case"end":return e.stop()}}),e)})))()},setStep:function(){this.task&&(this.task.type&&(this.validatedSteps[1]=!0,this.step=2),this.task.langs&&this.task.langs.length>0&&(this.validatedSteps[1]=!0,this.validatedSteps[2]=!0,this.step=3))}}},x=Object(l.a)(k,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.task?n("div",[n("mdb-stepper",{attrs:{buttons:"",simpleH:"",steps:t.steps,options:t.options,validation:"",validatedSteps:t.validatedSteps},on:{submit:function(e){return t.$router.push("/teacherinterface/materials/programming/"+t.task._id+"/view")},validate:t.setStep},scopedSlots:t._u([{key:"1",fn:function(){return[n("TaskType",{ref:"type",attrs:{task:t.task},on:{"set-task-type":t.setTaskType}})]},proxy:!0},{key:"2",fn:function(){return[n("TaskLangs",{ref:"languages",attrs:{task:t.task},on:{"set-langs":t.setTaskLangs}})]},proxy:!0},{key:"3",fn:function(){return[n("TaskTime",{attrs:{task:t.task},on:{"save-task-time":t.setTaskTime,"next-step":function(e){return t.$router.push("/teacherinterface/materials/programming/"+t.task._id+"/view")}}})]},proxy:!0}],null,!1,1152980476)})],1):n("div",[t._m(0)])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"ph-item"},[e("div",{staticClass:"ph-col-12"},[e("div",{staticClass:"ph-picture"}),this._v(" "),e("div",{staticClass:"ph-picture"})])])}],!1,null,"d1401a34",null);e.default=x.exports}}]);